version: '3'

services:
  # Sonarr - TV Show Management
  sonarr:
    image: linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_DIR}/sonarr:/config
      - ${DOWNLOADS_DIR}:/downloads
      - ${MEDIA_DIR}:/media
    ports:
      - "${SONARR_PORT}:8989"
    restart: unless-stopped

  # Radarr - Movie Management
  radarr:
    image: linuxserver/radarr:latest
    container_name: radarr
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_DIR}/radarr:/config
      - ${DOWNLOADS_DIR}:/downloads
      - ${MEDIA_DIR}:/media
    ports:
      - "${RADARR_PORT}:7878"
    restart: unless-stopped

  # Jellyseerr - Request Management
  jellyseerr:
    image: fallenbagel/jellyseerr:latest
    container_name: jellyseerr
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_DIR}/jellyseerr:/app/config
    ports:
      - "${JELLYSEERR_PORT}:5055"
    restart: unless-stopped
    depends_on:
      - jellyfin

  # Jellyfin - Media Server
  jellyfin:
    image: linuxserver/jellyfin:latest
    container_name: jellyfin
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_DIR}/jellyfin:/config
      - ${MEDIA_DIR}:/media
    ports:
      - "${JELLYFIN_PORT}:8096"
      - "${JELLYFIN_HTTPS_PORT}:8920" # Optional HTTPS port
      - "7359:7359/udp" # Optional discovery port
      - "1900:1900/udp" # Optional DLNA port
    restart: unless-stopped
    devices:
      - /dev/dri:/dev/dri # Optional: Hardware acceleration (Intel)
      # - /dev/vchiq:/dev/vchiq # Optional: Hardware acceleration (Raspberry Pi)

  # SABnzbd - Usenet Downloader
  sabnzbd:
    image: linuxserver/sabnzbd:latest
    container_name: sabnzbd
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${CONFIG_DIR}/sabnzbd:/config
      - ${DOWNLOADS_DIR}:/downloads
      - ${MEDIA_DIR}:/media
    ports:
      - "${SABNZBD_PORT}:8080"
    restart: unless-stopped

  # Transmission - BitTorrent Client
  transmission:
    image: linuxserver/transmission:latest
    container_name: transmission
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - USER=${TRANSMISSION_USER:-admin}
      - PASS=${TRANSMISSION_PASS:-adminadmin}
    volumes:
      - ${CONFIG_DIR}/transmission:/config
      - ${DOWNLOADS_DIR}:/downloads
      - ${DOWNLOADS_DIR}/watch:/watch
    ports:
      - "${TRANSMISSION_PORT}:9091"
      - "${TRANSMISSION_PEER_PORT}:51413"
      - "${TRANSMISSION_PEER_PORT}:51413/udp"
    restart: unless-stopped

volumes:
  media:
    driver: local

networks:
  default:
    name: media_network
